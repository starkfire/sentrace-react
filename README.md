# Sentrace

### **A BLE (Bluetooth Low Energy) Contact Tracer for Project Sentinel**

## Overview

Sentrace is a mobile application that uses BLE (_Bluetooth Low Energy_) to supplement contact tracing.

## Design

Sentrace only stores two key information: a unique identifier (`uniqueId`) which is generated by the app after installation, and the Bluetooth address of the device.

Sentrace detects all Bluetooth-enabled devices in range and logs their Bluetooth MAC addresses, which may be served by the device in random for security ([Read More](https://www.bluetooth.com/blog/bluetooth-technology-protecting-your-privacy/)).

## Development
Clone the repository
```
git clone https://github.com/starkfire/sentrace-react.git
cd sentrace-react
```
Install dependencies
```
npm install
npx react-native link react-native-ble-plx
```
Start Metro
```
npx react-native start
```
Open another terminal to build the app
```
npx react-native run-android
```
You can test the app on a device through USB, `adb`, or Wi-Fi (see [guide](https://reactnative.dev/docs/running-on-device)).

## Notes

`bleManager` returns device instances in the following format ([Reference](https://polidea.github.io/react-native-ble-plx/#device)):

```json
{
    "id": "27:97:8A:52:70:88",
    "isConnectable": null, 
    "localName": null, 
    "manufacturerData": "BgABDyACDCjILmhZ5l/hbhgFA77Azy7PaFB5xZs=", 
    "mtu": 23, 
    "name": null, 
    "overflowServiceUUIDs": null, 
    "rssi": -54,
    "serviceData": null, 
    "serviceUUIDs": null, 
    "solicitedServiceUUIDs": null, 
    "txPowerLevel": null
}
```

* `id`
  * Device Identifier: MAC [Android] / UUID [iOS] )
* `isConnectable` (iOS only)
  * indicates if device is connectable
* `localName` 
  * User friendly name on device
* `manufacturerData` 
  * Device manufacturer data
* `mtu` 
  * Maximum Transmission Unit, default: 23
* `name` 
  * Device Name
* `overflowServiceUUIDs` (iOS only)
  * List of overflow service UUIDs
* `rssi` 
  * Received Signal Strength Indication
* `serviceData` 
  * map of service UUIDs (as keys) with associated data (as values)
* `solicitedServiceUUIDs`
  * List of solicited service UUIDs
* `txPowerLevel`
  * Transmission power level of device

## Troubleshooting
#### Error: Device is not authorized to use BluetoothLE
Please enable location permissions for the app.

**_Note:_** While Sentrace does not actually store location data, Android requires location permissions for Bluetooth scans to work properly (see Android's [official guide](https://developer.android.com/guide/topics/connectivity/bluetooth-le#permissions) for BLE).

#### App does not recognize some devices even if their Bluetooth is turned on
You might need to check your `AndroidManifest.xml` and set permissions for your own use case.

Since Android provides built-in BLE support starting with Android 4.3, some devices may not support support BLE. So if you want to detect devices that don't support BLE as well, make sure the following is set to `false`:

```xml
<uses-feature android:name="android.hardware.bluetooth_le" android:required="false"/>
```

You can refer to Android's guide on [Bluetooth LE](https://developer.android.com/guide/topics/connectivity/bluetooth-le) for more information.

## API References

https://github.com/Polidea/react-native-ble-plx

https://polidea.github.io/react-native-ble-plx